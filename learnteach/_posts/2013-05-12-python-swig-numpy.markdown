---
layout: post
title: Python wrapping, with NumPy support, using SWIG
---

I recently learned how to use SWIG to wrap C++ code with Python, and to do so
with NumPy support. Here are some of the extant resources for learning how to
do this:

1. SWIG [documentation][swig]
2. NumPy SWIG interface file [documentation][numpyswig]
3. [Using CMake to build libraries generated by SWIG][cmakeswig]

I'm going to make this example as concrete and specific as possible.

---

## The given C++ library

We assume that we already have a C++ library that we want to wrap. That is, we
have the library's header files and shared libraries. We'll imagine that we're
trying to wrap part of a graphics library in which we can construct primitive
shapes. I make no claim that this is the right way to write a graphics library.

Suppose we have our own Vector class used to specify positions, etc., and a
Matrix class used to specify [rotation matrices][rotmat].

##### Vector.h
{% highlight c++ %}
namespace graphics {
template<class T> class Vector
{
public:
    /// @param initialValues: array of initial values, with specified length.
    Vector(int length, T* initialValues);
    T operator[](int index) { return _values[index]; }
private:
    std::vector _values;
};
}
{% endhighlight %}

##### Matrix.h
{% highlight c++ %}
namespace graphics {
template<class T> class Matrix
{
};
}
{% endhighlight %}

##### Shape.h
{% highlight c++ %}
namespace graphics {
class Shape
{
public:
    virtual void setPosition(Vector3f pos);
    virtual void setOrientation();
    virtual void draw() = 0;
};
}
{% endhighlight %}

Sphere.h
{% highlight c++ %}
namespace graphics {
class Sphere : public Shape
{
public:
    void draw();
};
}
{% endhighlight %}

##### Shape.cpp
{% highlight c++ %}
namespace graphics {
Shape::setPosition(Vec3f pos) {
    _position = pos;
}
}
{% endhighlight %}


## Setting up a SWIG target in CMake

## Creating an interface file

## Using typemaps

## Using NumPy arrays for input and output

{% highlight python %}
s = "Python syntax highlighting"
print s
{% endhighlight %}

[swig]: http://www.swig.org/Doc2.0/SWIGDocumentation.html
[numpyswig]: http://docs.scipy.org/doc/numpy/reference/swig.interface-file.html
[cmakeswig]: http://www.cmake.org/Wiki/CMake_FAQ#How_do_I_use_CMake_to_generate_SWIG_wrapper_libraries.3F
[rotmat]: http://en.wikipedia.org/wiki/Rotation_matrix
